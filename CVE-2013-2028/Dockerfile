FROM ubuntu:16.04

RUN apt update && apt install -y software-properties-common
RUN add-apt-repository ppa:deadsnakes/ppa
RUN apt-get update && apt-get install -y \
    build-essential \
    libpcre3-dev \
    zlib1g-dev \
    libssl-dev \
    libffi-dev \
    libncurses5-dev \
    aptitude \
    procps \
    gdb \
    git \
    vim \
    wget \
    tmux \
    strace \
    && rm -rf /var/lib/apt/lists/*

RUN aptitude install libglib2.0-dev
RUN wget http://nginx.org/download/nginx-1.3.9.tar.gz \
    && tar -xzvf nginx-1.3.9.tar.gz \
    && rm nginx-1.3.9.tar.gz

WORKDIR /nginx-1.3.9
RUN ./configure --without-http_rewrite_module --without-http_gzip_module \
    && make -j4 \
    && make install

WORKDIR /root
RUN wget -P ~ https://github.com/cyrus-and/gdb-dashboard/raw/master/.gdbinit

EXPOSE 80

CMD ["/usr/local/nginx/sbin/nginx", "-g", "daemon off;"]
