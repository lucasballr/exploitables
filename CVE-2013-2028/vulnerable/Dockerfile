# Use a base image of Debian
FROM ubuntu:16.04
# FROM ubuntu:22.04

# Set environment variables to avoid user interaction during package installation
# ENV DEBIAN_FRONTEND=noninteractive

# Update package lists and install build dependencies
# Nginx dependencies may include libraries for compression, SSL support, and more

RUN apt-get update && apt-get install -y \
    build-essential \
    libpcre3-dev \
    zlib1g-dev \
    libssl-dev \
    aptitude \
    procps \
    python3 \
    gdb \
    git \
    vim \
    wget \
    strace \
    && rm -rf /var/lib/apt/lists/*

RUN aptitude install libglib2.0-dev
# Download the source code of Nginx version 1.3.9
RUN wget http://nginx.org/download/nginx-1.3.9.tar.gz \
    && tar -xzvf nginx-1.3.9.tar.gz \
    && rm nginx-1.3.9.tar.gz

# Change directory into the extracted source code directory
WORKDIR /nginx-1.3.9

# Configure the build options for Nginx, then compile and install
RUN ./configure --without-http_rewrite_module --without-http_gzip_module \
    && make -j4\
    && make install

# Set the locale

WORKDIR /root
RUN wget https://github.com/pwndbg/pwndbg/releases/download/2024.02.14/pwndbg_2024.02.14_amd64.deb
RUN apt install ./pwndbg_2024.02.14_amd64.deb

# Expose port 80 for the web server
EXPOSE 80

# Start Nginx in the foreground so the container doesn't immediately exit
# CMD ["/usr/local/nginx/sbin/nginx", "-g", "daemon off;"]
CMD ["/bin/bash"]
